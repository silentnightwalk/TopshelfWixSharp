<?xml version="1.0" encoding="windows-1251"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="a0db8658-ed0a-4e68-a793-c69bf9bb2548" Name="TopshelfWixSharp" Language="1033" Codepage="Windows-1252" Version="1.0.0.0" UpgradeCode="a0db8658-ed0a-4e68-a793-c69be9bb2547" Manufacturer="Andrey">
    <Package InstallerVersion="200" Compressed="yes" SummaryCodepage="Windows-1252" Languages="1033" />
    <Media Id="1" Cabinet="TopshelfWixSharp.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="INSTALLDIR" Name="ABSOLUTEPATH">

        <Component Id="Component.TopshelfWixSharp.exe" Guid="a0db8658-ed0a-4e68-a793-c69beee33101">
          <File Id="TopshelfWixSharp.exe" Source="..\TopshelfWixSharp\bin\Debug\TopshelfWixSharp.exe" />
        </Component>

        <Component Id="Component.Topshelf.dll" Guid="a0db8658-ed0a-4e68-a793-c69bc4859166">
          <File Id="Topshelf.dll" Source="..\TopshelfWixSharp\bin\Debug\Topshelf.dll" />
        </Component>

      </Directory>
    </Directory>

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryKey="Action1_WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="WixSharp_BeforeInstall_Action" BinaryKey="Action1_WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_BeforeInstall_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_WixSharp_AfterInstall_Action_Props" Property="WixSharp_AfterInstall_Action" Value="WixSharp_AfterInstall_Handlers=[WixSharp_AfterInstall_Handlers];WIXSHARP_RUNTIME_DATA=[WIXSHARP_RUNTIME_DATA];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductName=[ProductName];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode]" />
    <CustomAction Id="WixSharp_AfterInstall_Action" BinaryKey="Action1_WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_AfterInstall_Action" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="Set_DirAbsolutePath" Property="INSTALLDIR" Value="C:\Program Files (x86)\TopshelfWixSharp" />

    <Binary Id="Action1_WixSharp_InitRuntime_Action_File" SourceFile="WixSharp.CA.dll" />

    <UIRef Id="WixUI_Minimal" />

    <Property Id="WixSharp_BeforeInstall_Handlers" Value="Installer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer.Setup|Project_BeforeInstall" />
    <Property Id="WixSharp_AfterInstall_Handlers" Value="Installer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer.Setup|Project_AfterInstall" />
    <Property Id="INSTALLDIR_ABSOLUTEPATH" Value="C:\Program Files (x86)\TopshelfWixSharp" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.TopshelfWixSharp.exe" />
      <ComponentRef Id="Component.Topshelf.dll" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="WixSharp_InitRuntime_Action" Before="AppSearch"> (1) </Custom>
      <Custom Action="WixSharp_BeforeInstall_Action" Before="InstallFiles">1</Custom>
      <Custom Action="Set_WixSharp_AfterInstall_Action_Props" After="InstallFiles" />
      <Custom Action="WixSharp_AfterInstall_Action" After="Set_WixSharp_AfterInstall_Action_Props">1</Custom>
      <Custom Action="Set_DirAbsolutePath" Before="AppSearch">(NOT Installed) AND (UILevel &lt; 5) AND (INSTALLDIR = ABSOLUTEPATH)</Custom>
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Action="Set_DirAbsolutePath" Before="AppSearch">(NOT Installed) AND (UILevel = 5) AND (INSTALLDIR = ABSOLUTEPATH)</Custom>
    </InstallUISequence>

  </Product>
</Wix>

